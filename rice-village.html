<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¨»é¦™æ‘ - ç»Ÿä¸€ç‰ˆæœ¬</title>
    <link rel="stylesheet" href="unified-styles.css?v=2.3">
</head>
<body>
    <div class="container">
        <!-- é¡µé¢æ ‡é¢˜ -->
        <div class="header">
            <h1>ç¨»é¦™æ‘ - RPGå†’é™©æ¨¡å¼</h1>
            <div class="subtitle">ç»Ÿä¸€ç‰ˆæœ¬ v2.0 | æ•°æ®å®Œå…¨åŒæ­¥</div>
        </div>

        <!-- å¯¼èˆªæ  -->
        <div class="nav-bar">
            <button class="nav-btn" onclick="goToTeaShop()">è¿”å›èŒ¶é“º</button>
            <button class="nav-btn" onclick="showInventory()" style="background: #666; color: white;">èƒŒåŒ…</button>
            <button class="nav-btn" onclick="showShop()" style="background: #666; color: white;">å•†åº—</button>
            <button class="nav-btn" onclick="showPartnerSelection()" style="background: #666; color: white;">é€‰æ‹©ä¼™ä¼´</button>
            <!-- æ ¸å¿ƒè°ƒè¯•åŠŸèƒ½ - æŒ‰ç…§é‡å»ºæŒ‡å¯¼æ–‡æ¡£ä¿ç•™ -->
            <button class="nav-btn" onclick="debugNPCStatus()" style="background: #666; color: white;">NPCçŠ¶æ€</button>
            <button class="nav-btn" onclick="debugCurrentQuests()" style="background: #666; color: white;">å½“å‰ä»»åŠ¡</button>
            <button class="nav-btn" onclick="resetKillData()" style="background: #666; color: white;">é‡ç½®å‡»æ€</button>
            <button class="nav-btn" onclick="resetAllGameData()" style="background: #d32f2f; color: white;">å®Œå…¨é‡ç½®</button>
        </div>

        <!-- å¤©æ°”æ—¶é—´ä¿¡æ¯æ  -->
        <div class="weather-info-bar" style="background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 8px; display: flex; justify-content: center; align-items: center; gap: 20px;">
            <div class="weather-display" style="display: flex; align-items: center; gap: 8px;">
                <span id="rice-weather-icon" style="font-size: 20px;">â˜€ï¸</span>
                <span id="rice-season-text" style="font-weight: 600; color: #333;">æ˜¥å¤© Â· æ™´å¤©</span>
            </div>
            <div class="day-display" style="display: flex; align-items: center; gap: 8px;">
                <span style="color: #666;">ç¬¬</span>
                <span id="rice-day-number" style="font-weight: 600; color: #333;">1</span>
                <span style="color: #666;">å¤©</span>
            </div>
        </div>

        <!-- è§’è‰²çŠ¶æ€æ  -->
        <div class="section">
            <div class="section-title">è§’è‰²çŠ¶æ€</div>
            <table class="status-table">
                <tr>
                    <th>å§“å</th>
                    <th>æ€§åˆ«</th>
                    <th>ç­‰çº§</th>
                    <th>ç»éªŒ</th>
                    <th>è¡€é‡</th>
                    <th>ä½“åŠ›</th>
                    <th>æ”»å‡»åŠ›</th>
                    <th>é‡‘å¸</th>
                </tr>
                <tr>
                    <td id="player-name">æœªè®¾ç½®</td>
                    <td id="player-gender">æœªè®¾ç½®</td>
                    <td id="player-level">1çº§</td>
                    <td id="player-exp">0/100</td>
                    <td id="player-hp">100/100</td>
                    <td id="player-stamina">100/100</td>
                    <td id="player-power">5</td>
                    <td id="player-funds">1000 ğŸª™</td>
                </tr>
            </table>
        </div>

        <!-- çŒ«å’ªä¼™ä¼´çŠ¶æ€ -->
        <div class="section">
            <div class="section-title">çŒ«å’ªä¼™ä¼´</div>
            <table class="status-table">
                <tr>
                    <th>å½“å‰ä¼™ä¼´</th>
                    <th>ç±»å‹</th>
                    <th>ç­‰çº§</th>
                    <th>è¡€é‡</th>
                    <th>æ”»å‡»åŠ›</th>
                    <th>æ“ä½œ</th>
                </tr>
                <tr>
                    <td id="cat-name">æœªé€‰æ‹©ä¼™ä¼´</td>
                    <td id="cat-type">-</td>
                    <td id="cat-level">-</td>
                    <td id="cat-hp">-</td>
                    <td id="cat-power">-</td>
                    <td>
                        <!-- æ—§æŒ‰é’®å·²åˆ é™¤ - ä½¿ç”¨å¯¼èˆªæ çš„ä¼™ä¼´é€‰æ‹©æŒ‰é’® -->
                    </td>
                </tr>
            </table>
        </div>

        <!-- å¿«é€Ÿæµ‹è¯•æŒ‰é’®å·²åˆ é™¤ - æŒ‰ç…§é‡å»ºæŒ‡å¯¼æ–‡æ¡£æ¸…ç†æ—§ç³»ç»Ÿ -->

        <!-- NPCå¯¹è¯åŒº -->
        <div class="section">
            <div class="section-title">æ‘æ°‘NPC</div>
            <table class="main-table">
                <thead>
                    <tr>
                        <th>NPCåç§°</th>
                        <th>èŒä¸š</th>
                        <th>ä»»åŠ¡çŠ¶æ€</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="npcs-table">
                    <!-- åŠ¨æ€ç”ŸæˆNPCçŠ¶æ€ -->
                </tbody>
            </table>
        </div>

        <!-- æˆ˜æ–—åŒºåŸŸ -->
        <div class="section">
            <div class="section-title">é‡ç”ŸåŠ¨ç‰©</div>
            <table class="main-table">
                <thead>
                    <tr>
                        <th>æ€ªç‰©åç§°</th>
                        <th>æè¿°</th>
                        <th>æ‰è½ç‰©å“</th>
                        <th>å½“å‰è¡€é‡</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="monsters-table">
                    <!-- åŠ¨æ€ç”Ÿæˆæ€ªç‰©çŠ¶æ€ -->
                </tbody>
            </table>
        </div>

        <!-- é‡‡é›†åŒºåŸŸ -->
        <div class="section">
            <div class="section-title">æ¤ç‰©é‡‡é›†</div>
            <table class="main-table">
                <thead>
                    <tr>
                        <th>æ¤ç‰©åç§°</th>
                        <th>æè¿°</th>
                        <th>ç”¨é€”</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="plants-table">
                    <!-- åŠ¨æ€ç”Ÿæˆæ¤ç‰©çŠ¶æ€ -->
                </tbody>
            </table>
        </div>

        <!-- è£…å¤‡ç®¡ç† -->
        <div class="section">
            <div class="section-title">è£…å¤‡ç®¡ç†</div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <!-- å½“å‰è£…å¤‡ -->
                <div>
                    <h4 style="font-size: 12px; margin-bottom: 8px;">å½“å‰è£…å¤‡</h4>
                    <table class="inventory-table">
                        <thead>
                            <tr><th>éƒ¨ä½</th><th>è£…å¤‡åç§°</th><th>å±æ€§</th><th>æ“ä½œ</th></tr>
                        </thead>
                        <tbody id="equipped-items">
                            <!-- åŠ¨æ€ç”Ÿæˆå½“å‰è£…å¤‡ -->
                        </tbody>
                    </table>
                </div>
                
                <!-- èƒŒåŒ…è£…å¤‡ -->
                <div>
                    <h4 style="font-size: 12px; margin-bottom: 8px;">èƒŒåŒ…è£…å¤‡</h4>
                    <table class="inventory-table">
                        <thead>
                            <tr><th>è£…å¤‡åç§°</th><th>ç±»å‹</th><th>å±æ€§</th><th>æ“ä½œ</th></tr>
                        </thead>
                        <tbody id="inventory-equipment">
                            <!-- åŠ¨æ€ç”ŸæˆèƒŒåŒ…è£…å¤‡ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- æ­¦å™¨é“ºå·²åˆ é™¤ - æŒ‰ç…§é‡å»ºæŒ‡å¯¼æ–‡æ¡£æ¸…ç†æ—§ç³»ç»Ÿ -->

        <!-- èƒŒåŒ…å¿«é€ŸæŸ¥çœ‹å·²åˆ é™¤ - æŒ‰ç…§é‡å»ºæŒ‡å¯¼æ–‡æ¡£ï¼ŒèƒŒåŒ…åº”ä¸ºå¼¹å‡ºçª—ä½“ -->
    </div>

    <!-- æ‚¬æµ®ä»»åŠ¡é¢æ¿ -->
    <div class="floating-panel" id="quest-panel">
        <h3>å½“å‰ä»»åŠ¡</h3>
        <div id="active-quests">
            <div style="color: #6b7280; font-size: 11px;">æš‚æ— è¿›è¡Œä¸­çš„ä»»åŠ¡</div>
        </div>
    </div>



    <!-- æ¨¡æ€æ¡†å®¹å™¨ -->
    <div id="modal-container"></div>



    <!-- æ—§æ‚¬æµ®èƒŒåŒ…å·²åˆ é™¤ - æŒ‰ç…§é‡å»ºæŒ‡å¯¼æ–‡æ¡£ä½¿ç”¨ç‹¬ç«‹èƒŒåŒ…ç³»ç»Ÿ -->

    <!-- æ­¦å™¨é“ºçª—å£å·²åˆ é™¤ - æŒ‰ç…§é‡å»ºæŒ‡å¯¼æ–‡æ¡£æ¸…ç†æ—§ç³»ç»Ÿ -->

    <!-- å¯¹è¯çª—ä½“ -->
    <div id="dialog-window" class="dialog-window">
        <div class="dialog-header">ğŸ’¬ å¯¹è¯</div>
        <div id="dialog-content" class="dialog-content"></div>
        <div id="dialog-options" class="dialog-options"></div>
    </div>

    <!-- JavaScriptæ–‡ä»¶ - æŒ‰ç…§é‡å»ºæ–‡æ¡£è¦æ±‚çš„æ­£ç¡®åŠ è½½é¡ºåº -->
    <script src="unified-core-system.js"></script>
    <script src="unified-inventory-system.js"></script>
    <script src="unified-weather-system.js"></script>
    <script src="rice-village-manager.js"></script>
    <script>
        // ç¡®ä¿ç³»ç»ŸæŒ‰æ­£ç¡®é¡ºåºåˆå§‹åŒ–
        function initializeRiceVillageSystem() {
            console.log('ğŸ® å¼€å§‹åˆå§‹åŒ–ç¨»é¦™æ‘ç³»ç»Ÿ...');
            
            // ç¬¬ä¸€æ­¥ï¼šç¡®ä¿æ ¸å¿ƒç³»ç»Ÿå­˜åœ¨å¹¶å·²åˆå§‹åŒ–
            if (!window.core || !window.core.initialized) {
                console.error('âŒ æ ¸å¿ƒç³»ç»Ÿæœªå°±ç»ª');
                console.log('æ ¸å¿ƒç³»ç»Ÿå­˜åœ¨:', !!window.core);
                console.log('æ ¸å¿ƒç³»ç»Ÿå·²åˆå§‹åŒ–:', window.core ? window.core.initialized : 'N/A');
                return false;
            }
            
            console.log('âœ… æ ¸å¿ƒç³»ç»Ÿå·²å°±ç»ª');
            
            // ç¬¬äºŒæ­¥ï¼šåˆ›å»ºå¹¶åˆå§‹åŒ–ç¨»é¦™æ‘ç®¡ç†å™¨
            if (!window.riceVillageManager) {
                try {
                    console.log('ğŸ—ï¸ åˆ›å»ºç¨»é¦™æ‘ç®¡ç†å™¨...');
                    window.riceVillageManager = new RiceVillageManager(window.core);
                    
                    console.log('ğŸš€ åˆå§‹åŒ–ç¨»é¦™æ‘ç®¡ç†å™¨...');
                    const success = window.riceVillageManager.initialize();
                    
                    if (success) {
                        console.log('âœ… ç¨»é¦™æ‘ç³»ç»Ÿåˆå§‹åŒ–æˆåŠŸï¼');
                        console.log('ğŸ¯ ç°åœ¨å¯ä»¥ä½¿ç”¨ä»»åŠ¡è¯Šæ–­åŠŸèƒ½ï¼šfullTaskDiagnosis()');
                        return true;
                    } else {
                        console.error('âŒ ç¨»é¦™æ‘ç®¡ç†å™¨åˆå§‹åŒ–å¤±è´¥');
                        return false;
                    }
                } catch (error) {
                    console.error('âŒ åˆ›å»ºç¨»é¦™æ‘ç®¡ç†å™¨å¤±è´¥:', error);
                    return false;
                }
            } else {
                console.log('âœ… ç¨»é¦™æ‘ç®¡ç†å™¨å·²å­˜åœ¨');
                return true;
            }
        }
        
        // é¡µé¢åŠ è½½å®ŒæˆåæŒ‰é¡ºåºåˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ® ç¨»é¦™æ‘é¡µé¢DOMåŠ è½½å®Œæˆ');
            
            // ä½¿ç”¨æ›´å¯é çš„åˆå§‹åŒ–æ—¶æœº
            if (window.core && window.core.initialized) {
                // æ ¸å¿ƒç³»ç»Ÿå·²å°±ç»ªï¼Œç«‹å³åˆå§‹åŒ–
                initializeRiceVillageSystem();
            } else {
                // æ ¸å¿ƒç³»ç»Ÿæœªå°±ç»ªï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´åé‡è¯•
                let retryCount = 0;
                const maxRetries = 10;
                
                const retryInit = () => {
                    retryCount++;
                    console.log(`ğŸ”„ ç¬¬${retryCount}æ¬¡å°è¯•åˆå§‹åŒ–ç¨»é¦™æ‘ç³»ç»Ÿ...`);
                    
                    if (initializeRiceVillageSystem()) {
                        console.log('ğŸ‰ ç¨»é¦™æ‘ç³»ç»Ÿåˆå§‹åŒ–æˆåŠŸï¼');
                        return;
                    }
                    
                    if (retryCount < maxRetries) {
                        setTimeout(retryInit, 200);
                    } else {
                        console.error('âŒ ç¨»é¦™æ‘ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥ï¼Œå·²è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°');
                        console.log('ğŸ’¡ è¯·æ‰‹åŠ¨åˆ·æ–°é¡µé¢é‡è¯•');
                    }
                };
                
                setTimeout(retryInit, 100);
            }
        });
    </script>

    <script>
        // ä¼™ä¼´é€‰æ‹©ç›¸å…³å…¨å±€å‡½æ•°
        function showCompanionSelector() {
            // è°ƒç”¨æ­£ç¡®çš„ä¼™ä¼´é€‰æ‹©å‡½æ•°
            showPartnerSelection();
        }

        function selectCompanionAndClose(originalName) {
            // è¿™ä¸ªå‡½æ•°æš‚æ—¶ä¸éœ€è¦ï¼Œä¼™ä¼´é€‰æ‹©é€šè¿‡æ¨¡æ€çª—å£å¤„ç†
            console.log('é€‰æ‹©ä¼™ä¼´:', originalName);
        }

        function closeCompanionSelector() {
            const modals = document.querySelectorAll('div[style*="position: fixed"]');
            modals.forEach(modal => {
                if (modal.innerHTML.includes('é€‰æ‹©çŒ«å’ªä¼™ä¼´')) {
                    modal.remove();
                }
            });
        }

        // è¿”å›èŒ¶é“ºå‡½æ•°
        function goToTeaShop() {
            // ä¿å­˜å½“å‰æ•°æ®
            if (window.riceVillageManager && window.riceVillageManager.core) {
                window.riceVillageManager.core.saveGameData();
            }

            // è·³è½¬åˆ°èŒ¶é“º
            window.location.href = 'index.html';
        }

        // æ˜¾ç¤ºå•†åº—ç•Œé¢
        function showShop() {
            if (!window.riceVillageManager || !window.riceVillageManager.core) {
                alert('âŒ ç³»ç»Ÿæœªåˆå§‹åŒ–ï¼Œè¯·åˆ·æ–°é¡µé¢');
                return;
            }

            const core = window.riceVillageManager.core;
            const inventorySystem = core.inventorySystem;
            const player = core.gameData.player;

            // æ ¹æ®é‡å»ºæŒ‡å¯¼æ–‡æ¡£çš„å•†åº—é…ç½®
            const shopItems = [
                { name: 'èœ‚èœœ', price: 3, category: 'toppings', description: 'å¤©ç„¶èœ‚èœœï¼Œç”œè€Œä¸è…»' },
                { name: 'é“¶è€³', price: 3, category: 'teaIngredients', description: 'æ»‹è¡¥é“¶è€³ï¼Œæ¶¦ç‡¥å…»é¢œ' },
                { name: 'çº¢ç³–', price: 2, category: 'toppings', description: 'æ¸©è¡¥çº¢ç³–ï¼Œæš–èƒƒé©±å¯’' },
                { name: 'å°é±¼å¹²', price: 5, category: 'specialItems', description: 'çŒ«å’ªæœ€çˆ±çš„å°é±¼å¹²' },
                { name: 'å†°ç³–', price: 3, category: 'toppings', description: 'æ¸…ç”œå†°ç³–ï¼Œæ¸…çƒ­æ¶¦ç‡¥' },
                // é¢èŒ¶æ–°å¢å•†åº—åŸæ–™
                { name: 'ç™½èŠéº»', price: 4, category: 'toppings', description: 'é¦™é†‡ç™½èŠéº»ï¼Œé¢èŒ¶å¿…å¤‡' },
                { name: 'èŠéº»é…±', price: 6, category: 'toppings', description: 'æµ“éƒèŠéº»é…±ï¼Œé¢èŒ¶ç²¾å' },
                { name: 'èƒ¡æ¤’ç²‰', price: 5, category: 'toppings', description: 'æ¸©çƒ­èƒ¡æ¤’ç²‰ï¼Œé¢èŒ¶è°ƒå‘³' }
            ];

            // åˆ›å»ºå•†åº—æ¨¡æ€æ¡†
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 1000;
                display: flex;
                justify-content: center;
                align-items: center;
            `;

            const shopPanel = document.createElement('div');
            shopPanel.style.cssText = `
                background: white;
                border-radius: 15px;
                padding: 20px;
                max-width: 600px;
                max-height: 80vh;
                overflow-y: auto;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            `;

            let shopHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 style="margin: 0; color: #333;">ğŸª ç¨»é¦™æ‘å•†åº—</h2>
                    <button onclick="closeShop()" style="background: #F44336; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-size: 16px;">âœ•</button>
                </div>

                <div style="margin-bottom: 15px; padding: 10px; background: #f5f5f5; border-radius: 5px;">
                    <strong>ğŸ’° å½“å‰é‡‘å¸ï¼š${player.funds}</strong>
                </div>

                <div style="display: grid; gap: 10px;">
            `;

            shopItems.forEach(item => {
                const canAfford = player.funds >= item.price;
                const buttonStyle = canAfford ?
                    'background: #4CAF50; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;' :
                    'background: #ccc; color: #666; border: none; padding: 8px 15px; border-radius: 5px; cursor: not-allowed;';

                shopHTML += `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        <div>
                            <strong>${item.name}</strong>
                            <div style="font-size: 12px; color: #666;">${item.description}</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-weight: bold; color: #333;">${item.price} é‡‘å¸</div>
                            <button onclick="buyShopItem('${item.name}', ${item.price}, '${item.category}')"
                                    style="${buttonStyle}"
                                    ${!canAfford ? 'disabled' : ''}>
                                è´­ä¹°
                            </button>
                        </div>
                    </div>
                `;
            });

            shopHTML += `
                </div>
                <div style="margin-top: 15px; padding: 10px; background: #e3f2fd; border-radius: 5px; font-size: 14px;">
                    <strong>ğŸ’¡ æç¤ºï¼š</strong>è´­ä¹°çš„ç‰©å“ä¼šè‡ªåŠ¨æ·»åŠ åˆ°èƒŒåŒ…ä¸­ï¼Œå¯åœ¨èŒ¶é“ºä½¿ç”¨ã€‚
                </div>
            `;

            shopPanel.innerHTML = shopHTML;
            modal.appendChild(shopPanel);
            document.body.appendChild(modal);

            // æ·»åŠ å…³é—­å•†åº—çš„å…¨å±€å‡½æ•°
            window.closeShop = function() {
                modal.remove();
                delete window.closeShop;
                delete window.buyShopItem;
            };

            // æ·»åŠ è´­ä¹°ç‰©å“çš„å…¨å±€å‡½æ•°
            window.buyShopItem = function(itemName, price, category) {
                if (player.funds < price) {
                    alert(`âŒ é‡‘å¸ä¸è¶³ï¼éœ€è¦ ${price} é‡‘å¸ï¼Œå½“å‰åªæœ‰ ${player.funds} é‡‘å¸ã€‚`);
                    return;
                }

                // æ‰£é™¤é‡‘å¸
                player.funds -= price;

                // æ·»åŠ ç‰©å“åˆ°èƒŒåŒ…
                inventorySystem.addItem(itemName, 1, category);

                // ä¿å­˜æ•°æ®
                core.saveGameData();

                // æ›´æ–°æ˜¾ç¤º
                alert(`âœ… æˆåŠŸè´­ä¹° ${itemName}ï¼èŠ±è´¹ ${price} é‡‘å¸ã€‚`);

                // å…³é—­å¹¶é‡æ–°æ‰“å¼€å•†åº—ä»¥æ›´æ–°é‡‘å¸æ˜¾ç¤º
                closeShop();
                showShop();
            };
        }



        // è°ƒè¯•ä»»åŠ¡ç³»ç»Ÿ
        function debugQuests() {
            if (!window.riceVillageManager || !window.riceVillageManager.core.initialized) {
                showSimpleAlert('é”™è¯¯ï¼šç¨»é¦™æ‘ç®¡ç†å™¨æœªåˆå§‹åŒ–ï¼');
                return;
            }

            const quests = window.riceVillageManager.core.gameData.quests;
            const killCounts = window.riceVillageManager.core.gameData.riceVillage.killCounts;

            console.log('ğŸ” === ä»»åŠ¡ç³»ç»Ÿè°ƒè¯•ä¿¡æ¯ ===');
            console.log('æ´»è·ƒä»»åŠ¡:', quests.active);
            console.log('å·²å®Œæˆä»»åŠ¡:', quests.completed);
            console.log('å‡»æ€ç»Ÿè®¡:', killCounts);

            let debugInfo = 'ğŸ” ä»»åŠ¡ç³»ç»Ÿè°ƒè¯•ä¿¡æ¯:\\n\\n';
            debugInfo += `æ´»è·ƒä»»åŠ¡æ•°é‡: ${quests.active.length}\\n`;
            debugInfo += `å·²å®Œæˆä»»åŠ¡æ•°é‡: ${quests.completed.length}\\n`;
            debugInfo += `é‡çŒªå‡»æ€æ•°: ${killCounts['é‡çŒª'] || 0}\\n\\n`;

            if (quests.active.length > 0) {
                debugInfo += 'æ´»è·ƒä»»åŠ¡è¯¦æƒ…:\\n';
                quests.active.forEach(quest => {
                    debugInfo += `- ${quest.name}: ${quest.progress}/${quest.required} (${quest.status})\\n`;
                });
            }

            showSimpleAlert(debugInfo);
        }

        // ç®€å•å¯é çš„å¼¹çª—å‡½æ•°

        function showSimpleAlert(message) {
            // ç§»é™¤å·²å­˜åœ¨çš„ç®€å•å¼¹çª—
            const existingAlert = document.getElementById('simple-alert');
            if (existingAlert) {
                existingAlert.remove();
            }

            // åˆ›å»ºç®€å•å¼¹çª—
            const alertDiv = document.createElement('div');
            alertDiv.id = 'simple-alert';
            alertDiv.innerHTML = `
                <div style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0,0,0,0.7);
                    z-index: 999999;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-family: Arial, sans-serif;
                ">
                    <div style="
                        background: white;
                        padding: 20px;
                        border-radius: 8px;
                        max-width: 400px;
                        width: 90%;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                        text-align: center;
                        word-wrap: break-word;
                    ">
                        <div style="
                            margin-bottom: 20px;
                            line-height: 1.6;
                            color: #333;
                            white-space: pre-line;
                            font-size: 14px;
                        ">${message}</div>
                        <button onclick="closeSimpleAlert()" style="
                            background: #4CAF50;
                            color: white;
                            border: none;
                            padding: 10px 20px;
                            border-radius: 4px;
                            cursor: pointer;
                            font-size: 14px;
                        ">ç¡®å®š</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(alertDiv);
            document.body.style.overflow = 'hidden';
            
            console.log('ç®€å•å¼¹çª—å·²æ˜¾ç¤º');
        }

        // å…³é—­ç®€å•å¼¹çª—
        function closeSimpleAlert() {
            const alertDiv = document.getElementById('simple-alert');
            if (alertDiv) {
                alertDiv.remove();
                document.body.style.overflow = '';
                console.log('ç®€å•å¼¹çª—å·²å…³é—­');
            }
        }
    </script>
</body>
</html>
